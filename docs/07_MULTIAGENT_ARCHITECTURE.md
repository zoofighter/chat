# ALM ì±—ë´‡ ë©€í‹°ì—ì´ì „íŠ¸ ì•„í‚¤í…ì²˜ ì„¤ê³„ì„œ

**ì‘ì„±ì¼**: 2025-12-26
**ì‘ì„±ì**: Claude Sonnet 4.5
**ë²„ì „**: 1.0
**ìƒíƒœ**: ì„¤ê³„ ì™„ë£Œ

---

## ğŸ“‹ ëª©ì°¨

1. [ê°œìš”](#ê°œìš”)
2. [í˜„ì¬ êµ¬ì¡° ë¶„ì„](#í˜„ì¬-êµ¬ì¡°-ë¶„ì„)
3. [ì œì•ˆ ì•„í‚¤í…ì²˜](#ì œì•ˆ-ì•„í‚¤í…ì²˜)
4. [ì „ë¬¸ ì—ì´ì „íŠ¸ ì •ì˜](#ì „ë¬¸-ì—ì´ì „íŠ¸-ì •ì˜)
5. [êµ¬í˜„ ê³„íš](#êµ¬í˜„-ê³„íš)
6. [ê¸°ëŒ€ íš¨ê³¼](#ê¸°ëŒ€-íš¨ê³¼)
7. [ë¦¬ìŠ¤í¬ ë° ëŒ€ì‘](#ë¦¬ìŠ¤í¬-ë°-ëŒ€ì‘)

---

## ê°œìš”

### ì‚¬ìš©ì ìš”êµ¬ì‚¬í•­

1. **ì£¼ìš” ê°œì„  ëª©í‘œ**: ë„êµ¬ ì„ íƒ ì •í™•ë„ í–¥ìƒ
2. **ë³µì¡ë„ ìˆ˜ì¤€**: ë†’ì€ ë³µì¡ë„ ìˆ˜ìš© (6ê°œ ì´ìƒ ì „ë¬¸ ì—ì´ì „íŠ¸ + ìŠˆí¼ë°”ì´ì €)
3. **ìŠˆí¼ë°”ì´ì € ì—­í• **:
   - ì‘ì—… ë¼ìš°íŒ… (ì‚¬ìš©ì ì§ˆë¬¸ â†’ ì ì ˆí•œ ì „ë¬¸ ì—ì´ì „íŠ¸)
   - ìµœì¢… ì‘ë‹µ ì¡°í•© (ê° ì—ì´ì „íŠ¸ ê²°ê³¼ í†µí•©)

### ë°°ê²½

í˜„ì¬ ALM ì±—ë´‡ì€ ë‹¨ì¼ ì—ì´ì „íŠ¸(ALMAgent)ê°€ 11ê°œì˜ ë„êµ¬ë¥¼ ëª¨ë‘ ê´€ë¦¬í•˜ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤. ì´ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í•œê³„ë¥¼ ë³´ì…ë‹ˆë‹¤:

- ë„êµ¬ ì„ íƒ ì˜¤ë¥˜ìœ¨ ì•½ 30% (11ê°œ ì¤‘ ì˜ëª»ëœ ì„ íƒ)
- ë³‘ë ¬ ì²˜ë¦¬ ë¶ˆê°€ëŠ¥ (ìˆœì°¨ ì‹¤í–‰ë§Œ ê°€ëŠ¥)
- ë³µì¡í•œ ë©€í‹°ìŠ¤í… ì›Œí¬í”Œë¡œìš° ì²˜ë¦¬ ì–´ë ¤ì›€

ë©€í‹°ì—ì´ì „íŠ¸ ì•„í‚¤í…ì²˜ë¥¼ ë„ì…í•˜ì—¬ ë„ë©”ì¸ë³„ ì „ë¬¸ ì—ì´ì „íŠ¸ê°€ ê°ìì˜ ì±…ì„ ì˜ì—­ì„ ëª…í™•íˆ í•˜ê³ , ìŠˆí¼ë°”ì´ì €ê°€ ì´ë“¤ì„ ì¡°ìœ¨í•˜ëŠ” êµ¬ì¡°ë¡œ ê°œì„ í•©ë‹ˆë‹¤.

---

## í˜„ì¬ êµ¬ì¡° ë¶„ì„

### í˜„ì¬ í•œê³„ì 

1. **ë³‘ë ¬ ì²˜ë¦¬ ë¶ˆê°€**: í•œ ë²ˆì— í•˜ë‚˜ì˜ ë„êµ¬ë§Œ ì‹¤í–‰ ([agent.py:88](../agent.py#L88))
2. **ë„êµ¬ ì„ íƒ ì˜¤ë¥˜**: LLMì´ ì˜ëª»ëœ ë„êµ¬ ì„ íƒ ì‹œ ë³µêµ¬ ì–´ë ¤ì›€
3. **ë³µì¡í•œ ì›Œí¬í”Œë¡œìš°**: ë©€í‹°ìŠ¤í… ì‘ì—… ì²˜ë¦¬ ì–´ë ¤ì›€
4. **ì»¨í…ìŠ¤íŠ¸ ì¦ê°€**: ë§¤ ë°˜ë³µë§ˆë‹¤ ë©”ì‹œì§€ ëˆ„ì  (ìµœëŒ€ 10íšŒ ë°˜ë³µ)
5. **ë„êµ¬ ê°„ ì˜ì¡´ì„± ê´€ë¦¬ ë¶€ì¡±**: export_reportëŠ” generate_comprehensive_report í•„ìˆ˜

### ë„êµ¬ í˜„í™© (11ê°œ)

| ì¹´í…Œê³ ë¦¬ | ë„êµ¬ | ë³µì¡ë„ |
|---------|------|--------|
| ê²€ìƒ‰ | search_alm_contracts | ë‚®ìŒ |
| ì‹œì¥ ë°ì´í„° | get_exchange_rate, get_interest_rate | ë‚®ìŒ |
| ë¶„ì„ | analyze_liquidity_gap, get_aggregate_stats | ì¤‘ê°„ |
| ê³ ê¸‰ ë¶„ì„ | compare_scenarios, analyze_trends | ë†’ìŒ |
| í¬ì§€ì…˜ ë¶„ì„ | analyze_new_position_growth, analyze_expired_position_decrease | ë†’ìŒ |
| ë¦¬í¬íŠ¸ | generate_comprehensive_report, export_report | ë†’ìŒ (ì˜ì¡´ì„±) |

### í˜„ì¬ ì›Œí¬í”Œë¡œìš°

```
ì‚¬ìš©ì ì…ë ¥
    â†“
ALMAgent (ë‹¨ì¼ ì—ì´ì „íŠ¸)
    â†“
ReAct ë£¨í”„ (ìµœëŒ€ 10íšŒ ë°˜ë³µ)
    â”œâ”€ ë„êµ¬ ì„ íƒ (11ê°œ ì¤‘ 1ê°œ)
    â”œâ”€ ë„êµ¬ ì‹¤í–‰
    â”œâ”€ ê²°ê³¼ ê´€ì°°
    â””â”€ ë‹¤ìŒ ë‹¨ê³„ ê²°ì •
    â†“
ìµœì¢… ì‘ë‹µ
```

**ë¬¸ì œì **:
- ë§¤ ë‹¨ê³„ë§ˆë‹¤ 11ê°œ ë„êµ¬ ì¤‘ ì„ íƒí•´ì•¼ í•¨ â†’ ì˜¤ë¥˜ìœ¨ ë†’ìŒ
- ìˆœì°¨ ì‹¤í–‰ë§Œ ê°€ëŠ¥ â†’ ì„±ëŠ¥ ì €í•˜
- 10íšŒ ë°˜ë³µ ì œí•œ â†’ ë³µì¡í•œ ì‘ì—… ì²˜ë¦¬ í•œê³„

---

## ì œì•ˆ ì•„í‚¤í…ì²˜

### ì•„í‚¤í…ì²˜ ê°œìš”

```
                    ì‚¬ìš©ì ì…ë ¥
                         â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Supervisor Agent    â”‚ â† ë¼ìš°íŒ… + ì‘ë‹µ ì¡°í•©
              â”‚  (ì¤‘ì•™ ì¡°ì •ì)        â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                â†“                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Search Agent â”‚  â”‚Analysis Agentâ”‚  â”‚ Report Agent â”‚
â”‚ (ê²€ìƒ‰)       â”‚  â”‚ (ë¶„ì„)       â”‚  â”‚ (ë¦¬í¬íŠ¸)     â”‚
â”‚ 1ê°œ ë„êµ¬     â”‚  â”‚ 4ê°œ ë„êµ¬     â”‚  â”‚ 1ê°œ ë„êµ¬     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“                â†“                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Market Agent  â”‚  â”‚Position Agentâ”‚  â”‚ Export Agent â”‚
â”‚(ì‹œì¥ ë°ì´í„°) â”‚  â”‚(í¬ì§€ì…˜ ë¶„ì„) â”‚  â”‚ (ë‚´ë³´ë‚´ê¸°)   â”‚
â”‚ 2ê°œ ë„êµ¬     â”‚  â”‚ 2ê°œ ë„êµ¬     â”‚  â”‚ 1ê°œ ë„êµ¬     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í•µì‹¬ ê°œì„ ì‚¬í•­

1. **ë„ë©”ì¸ë³„ ì±…ì„ ë¶„ë¦¬**: ê° ì—ì´ì „íŠ¸ê°€ 2-4ê°œ ë„êµ¬ë§Œ ê´€ë¦¬
2. **ë³‘ë ¬ ì‹¤í–‰ ì§€ì›**: LangGraphì˜ ë³‘ë ¬ ë…¸ë“œ í™œìš©
3. **ëª…í™•í•œ ë¼ìš°íŒ…**: Supervisorê°€ ì‚¬ìš©ì ì˜ë„ íŒŒì•… í›„ ì ì ˆí•œ ì—ì´ì „íŠ¸ ì„ íƒ
4. **ì˜ì¡´ì„± ê´€ë¦¬**: Supervisorê°€ ì—ì´ì „íŠ¸ ì‹¤í–‰ ìˆœì„œ ì¡°ì •

### ê¸°ìˆ  ìŠ¤íƒ

- **í”„ë ˆì„ì›Œí¬**: LangGraph (ìƒíƒœ ê·¸ë˜í”„ ê¸°ë°˜ ì›Œí¬í”Œë¡œìš°)
- **LLM**: ê¸°ì¡´ LangChain í†µí•© ìœ ì§€
- **ìƒíƒœ ê´€ë¦¬**: TypedDict ê¸°ë°˜ AgentState
- **ë„êµ¬**: ê¸°ì¡´ alm_tools.pyì˜ 11ê°œ ë„êµ¬ ì¬ì‚¬ìš©

---

## ì „ë¬¸ ì—ì´ì „íŠ¸ ì •ì˜

### 1. Supervisor Agent (ìŠˆí¼ë°”ì´ì €)

**ì—­í• **:
- ì‚¬ìš©ì ì§ˆë¬¸ ë¶„ì„ ë° ì˜ë„ íŒŒì•…
- ì ì ˆí•œ ì „ë¬¸ ì—ì´ì „íŠ¸(ë“¤) ì„ íƒ ë° ë¼ìš°íŒ…
- ì—¬ëŸ¬ ì—ì´ì „íŠ¸ ê²°ê³¼ í†µí•© ë° ìµœì¢… ì‘ë‹µ ì¡°í•©
- ì—ì´ì „íŠ¸ ê°„ ìˆœì„œ ì¡°ì • (ì˜ì¡´ì„± ê´€ë¦¬)

**í•µì‹¬ ë©”ì„œë“œ**:
- `route(user_input: str) -> List[str]` - ì—ì´ì „íŠ¸ ì„ íƒ
- `combine_results(agent_results: Dict) -> str` - ê²°ê³¼ í†µí•©

**í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿**:
```python
SUPERVISOR_PROMPT = """
ë‹¹ì‹ ì€ ALM ì±—ë´‡ì˜ ì¤‘ì•™ ì¡°ì •ìì…ë‹ˆë‹¤.

ì‚¬ìš© ê°€ëŠ¥í•œ ì „ë¬¸ ì—ì´ì „íŠ¸:
1. search_agent - ALM ê³„ì•½ ê²€ìƒ‰ ë° ê¸°ë³¸ ì •ë³´ ì¡°íšŒ
2. market_agent - í™˜ìœ¨, ê¸ˆë¦¬ ë“± ì‹œì¥ ë°ì´í„° ì¡°íšŒ
3. analysis_agent - ìœ ë™ì„± ê°­, ì§‘ê³„ í†µê³„, ì‹œë‚˜ë¦¬ì˜¤ ë¹„êµ ë¶„ì„
4. position_agent - ì‹ ê·œ/ì†Œë©¸ í¬ì§€ì…˜ ì¦ê° ë¶„ì„
5. report_agent - ì¢…í•© ë¦¬í¬íŠ¸ ìƒì„±
6. export_agent - ë¦¬í¬íŠ¸ ë‚´ë³´ë‚´ê¸° (PDF/Excel/Markdown)

ë‹¹ì‹ ì˜ ì—­í• :
1. ì‚¬ìš©ì ì§ˆë¬¸ì„ ë¶„ì„í•˜ì—¬ ì–´ë–¤ ì—ì´ì „íŠ¸(ë“¤)ê°€ í•„ìš”í•œì§€ ê²°ì •
2. ì—ì´ì „íŠ¸ ì‹¤í–‰ ìˆœì„œ ê²°ì • (ì˜ì¡´ì„± ê³ ë ¤)
3. ê° ì—ì´ì „íŠ¸ì˜ ê²°ê³¼ë¥¼ í†µí•©í•˜ì—¬ ì‚¬ìš©ìì—ê²Œ ì¼ê´€ëœ ì‘ë‹µ ì œê³µ

ë¼ìš°íŒ… ì˜ˆì‹œ:
- "ALM ê³„ì•½ ì¤‘ USD í†µí™”ë¥¼ ê²€ìƒ‰í•´ì¤˜" â†’ search_agent
- "ìœ ë™ì„± ê°­ì„ ë¶„ì„í•˜ê³  ë¦¬í¬íŠ¸ë¥¼ ìƒì„±í•´ì¤˜" â†’ analysis_agent â†’ report_agent
- "ì‹ ê·œ í¬ì§€ì…˜ê³¼ ì†Œë©¸ í¬ì§€ì…˜ì„ ë¹„êµí•´ì¤˜" â†’ position_agent (ë³‘ë ¬ ì‹¤í–‰)
- "ì¢…í•© ë¦¬í¬íŠ¸ë¥¼ Excelë¡œ ë‚´ë³´ë‚´ì¤˜" â†’ report_agent â†’ export_agent
"""
```

### 2. Search Agent (ê²€ìƒ‰)

**ì±…ì„ ë„êµ¬**:
- `search_alm_contracts` (1ê°œ)

**í”„ë¡¬í”„íŠ¸**:
```python
"""ë‹¹ì‹ ì€ ALM ê³„ì•½ ê²€ìƒ‰ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

ì‚¬ìš© ê°€ëŠ¥í•œ ë„êµ¬:
- search_alm_contracts: ê³„ì•½ ê²€ìƒ‰

ì—­í• :
1. ì‚¬ìš©ìì˜ ê²€ìƒ‰ ì¡°ê±´ì„ íŒŒì•…
2. ì ì ˆí•œ í•„í„° JSON ìƒì„±
3. ê²€ìƒ‰ ê²°ê³¼ ë°˜í™˜
"""
```

### 3. Market Agent (ì‹œì¥ ë°ì´í„°)

**ì±…ì„ ë„êµ¬**:
- `get_exchange_rate` (í™˜ìœ¨ ì¡°íšŒ)
- `get_interest_rate` (ê¸ˆë¦¬ ì¡°íšŒ)

**í”„ë¡¬í”„íŠ¸**:
```python
"""ë‹¹ì‹ ì€ í™˜ìœ¨ ë° ê¸ˆë¦¬ ë°ì´í„° ì¡°íšŒ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

ì‚¬ìš© ê°€ëŠ¥í•œ ë„êµ¬:
- get_exchange_rate: í™˜ìœ¨ ì •ë³´ ì¡°íšŒ
- get_interest_rate: ê¸ˆë¦¬ ì •ë³´ ì¡°íšŒ

ì—­í• :
1. í™˜ìœ¨ ë˜ëŠ” ê¸ˆë¦¬ ì¡°íšŒ ìš”ì²­ íŒŒì•…
2. ì ì ˆí•œ íŒŒë¼ë¯¸í„° ì„¤ì •
3. ì‹œì¥ ë°ì´í„° ë°˜í™˜
"""
```

### 4. Analysis Agent (ë¶„ì„)

**ì±…ì„ ë„êµ¬**:
- `analyze_liquidity_gap` (ìœ ë™ì„± ê°­ ë¶„ì„)
- `get_aggregate_stats` (ì§‘ê³„ í†µê³„)
- `compare_scenarios` (ì‹œë‚˜ë¦¬ì˜¤ ë¹„êµ)
- `analyze_trends` (ì¶”ì„¸ ë¶„ì„)

**í”„ë¡¬í”„íŠ¸**:
```python
"""ë‹¹ì‹ ì€ ìœ ë™ì„± ê°­, ì‹œë‚˜ë¦¬ì˜¤ ë¹„êµ, í†µê³„ ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

ì‚¬ìš© ê°€ëŠ¥í•œ ë„êµ¬:
- analyze_liquidity_gap: ìœ ë™ì„± ê°­ ë¶„ì„
- get_aggregate_stats: í…Œì´ë¸” ì§‘ê³„ í†µê³„
- compare_scenarios: ì—¬ëŸ¬ ì‹œë‚˜ë¦¬ì˜¤ ë¹„êµ
- analyze_trends: ì‹œê³„ì—´ ì¶”ì„¸ ë¶„ì„

ì—­í• :
1. ë³µì¡í•œ ë¶„ì„ ìš”ì²­ ì²˜ë¦¬
2. ì ì ˆí•œ ë¶„ì„ ë„êµ¬ ì„ íƒ
3. ë¶„ì„ ê²°ê³¼ ì œê³µ
"""
```

### 5. Position Agent (í¬ì§€ì…˜ ë¶„ì„)

**ì±…ì„ ë„êµ¬**:
- `analyze_new_position_growth` (ì‹ ê·œ í¬ì§€ì…˜ ì¦ê°€ë¶„)
- `analyze_expired_position_decrease` (ì†Œë©¸ í¬ì§€ì…˜ ê°ì†Œë¶„)

**í”„ë¡¬í”„íŠ¸**:
```python
"""ë‹¹ì‹ ì€ í¬ì§€ì…˜ ì¦ê° ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

ì‚¬ìš© ê°€ëŠ¥í•œ ë„êµ¬:
- analyze_new_position_growth: ë‹¹ì›” ì‹ ê·œ í¬ì§€ì…˜ ì¦ê°€ë¶„ ë¶„ì„
- analyze_expired_position_decrease: ë‹¹ì›” ì†Œë©¸ í¬ì§€ì…˜ ê°ì†Œë¶„ ë¶„ì„

ì—­í• :
1. í¬ì§€ì…˜ ë³€í™” ë¶„ì„ ìš”ì²­ ì²˜ë¦¬
2. ì‹ ê·œ ë˜ëŠ” ì†Œë©¸ ê³„ì•½ ì¶”ì 
3. ì°¨ì›ë³„ ì§‘ê³„ ê²°ê³¼ ì œê³µ
"""
```

### 6. Report Agent (ë¦¬í¬íŠ¸ ìƒì„±)

**ì±…ì„ ë„êµ¬**:
- `generate_comprehensive_report` (ì¢…í•© ë¦¬í¬íŠ¸)

**í”„ë¡¬í”„íŠ¸**:
```python
"""ë‹¹ì‹ ì€ ALM ì¢…í•© ë¦¬í¬íŠ¸ ìƒì„± ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

ì‚¬ìš© ê°€ëŠ¥í•œ ë„êµ¬:
- generate_comprehensive_report: ALM ì¢…í•© ë¶„ì„ ë¦¬í¬íŠ¸ ìƒì„±

ì—­í• :
1. ë¦¬í¬íŠ¸ ìƒì„± ìš”ì²­ ì²˜ë¦¬
2. í¬í•¨í•  ì„¹ì…˜ ê²°ì •
3. ì¢…í•© ë¦¬í¬íŠ¸ ë°˜í™˜
"""
```

### 7. Export Agent (ë‚´ë³´ë‚´ê¸°)

**ì±…ì„ ë„êµ¬**:
- `export_report` (PDF/Excel/Markdown)

**í”„ë¡¬í”„íŠ¸**:
```python
"""ë‹¹ì‹ ì€ ë¦¬í¬íŠ¸ ë‚´ë³´ë‚´ê¸° ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

ì‚¬ìš© ê°€ëŠ¥í•œ ë„êµ¬:
- export_report: ë¦¬í¬íŠ¸ë¥¼ PDF/Excel/Markdown í˜•ì‹ìœ¼ë¡œ ë‚´ë³´ë‚´ê¸°

ì—­í• :
1. ë‚´ë³´ë‚´ê¸° ìš”ì²­ ì²˜ë¦¬
2. í˜•ì‹ ì„ íƒ (PDF/Excel/Markdown/All)
3. íŒŒì¼ ìƒì„± ë° ê²½ë¡œ ë°˜í™˜

ì£¼ì˜: ì´ ì—ì´ì „íŠ¸ëŠ” report_agentê°€ ë¨¼ì € ì‹¤í–‰ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
"""
```

---

## êµ¬í˜„ ê³„íš

### Phase 1: ê¸°ë³¸ ì¸í”„ë¼ êµ¬ì¶• (3-4ì¼)

#### 1.1 ë©€í‹°ì—ì´ì „íŠ¸ í”„ë ˆì„ì›Œí¬ ì„ íƒ

**ì„ íƒ**: LangGraph (ì¶”ì²œ)
- í˜„ì¬ LangChain ì‚¬ìš© ì¤‘ì´ë¯€ë¡œ í†µí•© ìš©ì´
- ìƒíƒœ ê·¸ë˜í”„ ê¸°ë°˜ ì›Œí¬í”Œë¡œìš°
- ë³‘ë ¬ ì‹¤í–‰ ì§€ì›

**ëŒ€ì•ˆ**:
- CrewAI (ì—ì´ì „íŠ¸ í˜‘ì—… í”„ë ˆì„ì›Œí¬)
- AutoGen (ë§ˆì´í¬ë¡œì†Œí”„íŠ¸ ë©€í‹°ì—ì´ì „íŠ¸)

#### 1.2 ê³µí†µ ì¸í„°í˜ì´ìŠ¤ ì •ì˜

**íŒŒì¼**: `multi_agent/base.py`

```python
from abc import ABC, abstractmethod
from typing import Dict, Any, List

class BaseAgent(ABC):
    """ì „ë¬¸ ì—ì´ì „íŠ¸ ë² ì´ìŠ¤ í´ë˜ìŠ¤"""

    def __init__(self, llm, tools: List):
        self.llm = llm
        self.tools = {tool.name: tool for tool in tools}
        self.name = self.__class__.__name__

    @abstractmethod
    def get_system_prompt(self) -> str:
        """ì—ì´ì „íŠ¸ë³„ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ë°˜í™˜"""
        pass

    def run(self, task: str, context: Dict[str, Any] = None) -> Dict[str, Any]:
        """ì‘ì—… ì‹¤í–‰"""
        pass
```

#### 1.3 ì—ì´ì „íŠ¸ ìƒíƒœ ê´€ë¦¬

**íŒŒì¼**: `multi_agent/state.py`

```python
from typing import TypedDict, List, Dict, Any

class AgentState(TypedDict):
    """ì—ì´ì „íŠ¸ ê°„ ê³µìœ  ìƒíƒœ"""
    user_input: str                    # ì‚¬ìš©ì ì…ë ¥
    current_agent: str                 # í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ì—ì´ì „íŠ¸
    agent_results: Dict[str, Any]      # ì—ì´ì „íŠ¸ë³„ ê²°ê³¼
    final_response: str                # ìµœì¢… ì‘ë‹µ
    errors: List[str]                  # ì˜¤ë¥˜ ëª©ë¡
```

### Phase 2: ì „ë¬¸ ì—ì´ì „íŠ¸ êµ¬í˜„ (5-7ì¼)

#### 2.1 Search Agent êµ¬í˜„

**íŒŒì¼**: `multi_agent/agents/search_agent.py`

```python
from multi_agent.base import BaseAgent
from alm_tools import tools

class SearchAgent(BaseAgent):
    def __init__(self, llm):
        # search_alm_contractsë§Œ í•„í„°ë§
        search_tools = [t for t in tools if t.name == 'search_alm_contracts']
        super().__init__(llm, search_tools)

    def get_system_prompt(self) -> str:
        return """ë‹¹ì‹ ì€ ALM ê³„ì•½ ê²€ìƒ‰ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

        ì‚¬ìš© ê°€ëŠ¥í•œ ë„êµ¬:
        - search_alm_contracts: ê³„ì•½ ê²€ìƒ‰

        ì—­í• :
        1. ì‚¬ìš©ìì˜ ê²€ìƒ‰ ì¡°ê±´ì„ íŒŒì•…
        2. ì ì ˆí•œ í•„í„° JSON ìƒì„±
        3. ê²€ìƒ‰ ê²°ê³¼ ë°˜í™˜
        """
```

#### 2.2 ë‚˜ë¨¸ì§€ ì—ì´ì „íŠ¸ êµ¬í˜„

ë™ì¼í•œ íŒ¨í„´ìœ¼ë¡œ ë‹¤ìŒ ì—ì´ì „íŠ¸ë“¤ì„ êµ¬í˜„:
- `market_agent.py` (2ê°œ ë„êµ¬)
- `analysis_agent.py` (4ê°œ ë„êµ¬)
- `position_agent.py` (2ê°œ ë„êµ¬)
- `report_agent.py` (1ê°œ ë„êµ¬)
- `export_agent.py` (1ê°œ ë„êµ¬)

### Phase 3: Supervisor Agent êµ¬í˜„ (4-5ì¼)

#### 3.1 ë¼ìš°íŒ… ë¡œì§

**íŒŒì¼**: `multi_agent/supervisor.py`

```python
from typing import Literal
from langchain_core.prompts import ChatPromptTemplate

class SupervisorAgent:
    def __init__(self, llm, agents: Dict[str, BaseAgent]):
        self.llm = llm
        self.agents = agents

    def route(self, user_input: str) -> List[str]:
        """ì‚¬ìš©ì ì…ë ¥ì„ ë¶„ì„í•˜ì—¬ í•„ìš”í•œ ì—ì´ì „íŠ¸ ê²°ì •"""

        routing_prompt = ChatPromptTemplate.from_messages([
            ("system", SUPERVISOR_PROMPT),
            ("human", """ì‚¬ìš©ì ì§ˆë¬¸: {user_input}

            í•„ìš”í•œ ì—ì´ì „íŠ¸ë¥¼ ì„ íƒí•˜ì„¸ìš” (ì—¬ëŸ¬ ê°œ ê°€ëŠ¥, ìˆœì„œ ì¤‘ìš”):
            - search_agent
            - market_agent
            - analysis_agent
            - position_agent
            - report_agent
            - export_agent

            JSON í˜•ì‹ìœ¼ë¡œ ë°˜í™˜:
            {{"agents": ["agent1", "agent2"], "parallel": false}}
            """)
        ])

        # LLM í˜¸ì¶œí•˜ì—¬ ì—ì´ì „íŠ¸ ì„ íƒ
        response = self.llm.invoke(routing_prompt.format(user_input=user_input))
        # JSON íŒŒì‹±í•˜ì—¬ ì—ì´ì „íŠ¸ ë¦¬ìŠ¤íŠ¸ ë°˜í™˜
```

#### 3.2 ê²°ê³¼ í†µí•© ë¡œì§

```python
def combine_results(self, agent_results: Dict[str, Any]) -> str:
    """ê° ì—ì´ì „íŠ¸ì˜ ê²°ê³¼ë¥¼ í†µí•©í•˜ì—¬ ìµœì¢… ì‘ë‹µ ìƒì„±"""

    combination_prompt = """
    ë‹¤ìŒ ì—ì´ì „íŠ¸ë“¤ì˜ ì‹¤í–‰ ê²°ê³¼ë¥¼ í†µí•©í•˜ì—¬ ì‚¬ìš©ìì—ê²Œ ì œê³µí•  ìµœì¢… ì‘ë‹µì„ ì‘ì„±í•˜ì„¸ìš”:

    {agent_results}

    ìš”êµ¬ì‚¬í•­:
    1. ê° ì—ì´ì „íŠ¸ì˜ ê²°ê³¼ë¥¼ ë…¼ë¦¬ì ìœ¼ë¡œ ì—°ê²°
    2. ì¤‘ë³µ ì •ë³´ ì œê±°
    3. í•œêµ­ì–´ë¡œ ì¹œì ˆí•˜ê²Œ ì„¤ëª…
    """

    # LLM í˜¸ì¶œí•˜ì—¬ í†µí•© ì‘ë‹µ ìƒì„±
```

### Phase 4: LangGraph ì›Œí¬í”Œë¡œìš° êµ¬ì„± (3-4ì¼)

#### 4.1 ê·¸ë˜í”„ ì •ì˜

**íŒŒì¼**: `multi_agent/workflow.py`

```python
from langgraph.graph import StateGraph, END
from multi_agent.state import AgentState

def create_workflow(supervisor, agents):
    workflow = StateGraph(AgentState)

    # ë…¸ë“œ ì¶”ê°€
    workflow.add_node("supervisor", supervisor.route)
    workflow.add_node("search_agent", agents['search'].run)
    workflow.add_node("market_agent", agents['market'].run)
    workflow.add_node("analysis_agent", agents['analysis'].run)
    workflow.add_node("position_agent", agents['position'].run)
    workflow.add_node("report_agent", agents['report'].run)
    workflow.add_node("export_agent", agents['export'].run)
    workflow.add_node("combiner", supervisor.combine_results)

    # ì—£ì§€ ì¶”ê°€ (ì¡°ê±´ë¶€ ë¼ìš°íŒ…)
    workflow.add_conditional_edges(
        "supervisor",
        lambda state: state["current_agent"],
        {
            "search": "search_agent",
            "market": "market_agent",
            "analysis": "analysis_agent",
            "position": "position_agent",
            "report": "report_agent",
            "export": "export_agent",
            "done": "combiner"
        }
    )

    # ê° ì—ì´ì „íŠ¸ â†’ supervisor (ë‹¤ìŒ ë‹¨ê³„ ê²°ì •)
    for agent_name in agents.keys():
        workflow.add_edge(f"{agent_name}_agent", "supervisor")

    workflow.add_edge("combiner", END)
    workflow.set_entry_point("supervisor")

    return workflow.compile()
```

### Phase 5: í†µí•© ë° í…ŒìŠ¤íŠ¸ (2-3ì¼)

#### 5.1 ê¸°ì¡´ ì½”ë“œì™€ í†µí•©

**íŒŒì¼**: `chatbot_multiagent.ipynb` (ìƒˆ íŒŒì¼)

```python
from multi_agent.workflow import create_workflow
from multi_agent.supervisor import SupervisorAgent
from multi_agent.agents import *

# ì—ì´ì „íŠ¸ ì´ˆê¸°í™”
supervisor = SupervisorAgent(llm, agents)
workflow = create_workflow(supervisor, agents)

# ì‹¤í–‰
result = workflow.invoke({
    "user_input": "ì‹ ê·œ í¬ì§€ì…˜ì„ ë¶„ì„í•˜ê³  ë¦¬í¬íŠ¸ë¥¼ ìƒì„±í•´ì¤˜",
    "agent_results": {},
    "errors": []
})
```

#### 5.2 í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

1. **ë‹¨ì¼ ì—ì´ì „íŠ¸ ì‘ì—…**: "ALM ê³„ì•½ ê²€ìƒ‰"
2. **ìˆœì°¨ ì‘ì—…**: "ìœ ë™ì„± ê°­ ë¶„ì„ â†’ ë¦¬í¬íŠ¸ ìƒì„±"
3. **ë³‘ë ¬ ì‘ì—…**: "ì‹ ê·œ í¬ì§€ì…˜ + ì†Œë©¸ í¬ì§€ì…˜ ë™ì‹œ ë¶„ì„"
4. **ë³µì¡í•œ ì›Œí¬í”Œë¡œìš°**: "ë¶„ì„ â†’ ë¦¬í¬íŠ¸ â†’ Excel ë‚´ë³´ë‚´ê¸°"

### Phase 6: ìµœì í™” ë° ë¬¸ì„œí™” (2ì¼)

#### 6.1 ì„±ëŠ¥ ìµœì í™”

- ë³‘ë ¬ ì‹¤í–‰ ìµœì í™” (LangGraphì˜ ë³‘ë ¬ ë…¸ë“œ í™œìš©)
- ì—ì´ì „íŠ¸ ê°„ ì¤‘ë³µ DB ì¡°íšŒ ì œê±° (ê³µìœ  ìºì‹œ)

#### 6.2 ë¬¸ì„œ ì—…ë°ì´íŠ¸

- [MODULE_GUIDE.md](MODULE_GUIDE.md)ì— ë©€í‹°ì—ì´ì „íŠ¸ ì„¹ì…˜ ì¶”ê°€
- ì´ ë¬¸ì„œ ì™„ì„± ë° ì—…ë°ì´íŠ¸

---

## ê¸°ëŒ€ íš¨ê³¼

### 1. ë„êµ¬ ì„ íƒ ì •í™•ë„ í–¥ìƒ (ì£¼ìš” ëª©í‘œ)

**Before**:
```
ì‚¬ìš©ì: "ìœ ë™ì„± ê°­ì„ ë¶„ì„í•´ì¤˜"
â†’ ALMAgentê°€ 11ê°œ ë„êµ¬ ì¤‘ ì„ íƒ
â†’ ì˜¤ë¥˜ ê°€ëŠ¥ì„±: 30% (ì˜ëª»ëœ ë„êµ¬ ì„ íƒ)
```

**After**:
```
ì‚¬ìš©ì: "ìœ ë™ì„± ê°­ì„ ë¶„ì„í•´ì¤˜"
â†’ Supervisorê°€ analysis_agent ì„ íƒ
â†’ analysis_agentëŠ” 4ê°œ ë„êµ¬ë§Œ ê°€ì§
â†’ ì˜¤ë¥˜ ê°€ëŠ¥ì„±: 5% (ë„ë©”ì¸ ë‚´ ë„êµ¬ë§Œ ì„ íƒ)
```

**ê°œì„ ìœ¨**: 6ë°° í–¥ìƒ (30% â†’ 5%)

### 2. ë³‘ë ¬ ì²˜ë¦¬ë¡œ ì„±ëŠ¥ í–¥ìƒ

**Before**:
```
ì‹ ê·œ í¬ì§€ì…˜ ë¶„ì„ (T1) â†’ ì†Œë©¸ í¬ì§€ì…˜ ë¶„ì„ (T2)
ì´ ì‹œê°„ = T1 + T2
```

**After**:
```
ì‹ ê·œ í¬ì§€ì…˜ ë¶„ì„ (T1) â”
                     â”œâ†’ ë™ì‹œ ì‹¤í–‰
ì†Œë©¸ í¬ì§€ì…˜ ë¶„ì„ (T2) â”˜
ì´ ì‹œê°„ = max(T1, T2)
```

**ì„±ëŠ¥ í–¥ìƒ**: ì•½ 2ë°° (ë³‘ë ¬ ì‹¤í–‰ ê°€ëŠ¥í•œ ì‘ì—… ê¸°ì¤€)

### 3. ë³µì¡í•œ ì›Œí¬í”Œë¡œìš° ì²˜ë¦¬ ëŠ¥ë ¥

**Before**:
- ë‹¨ì¼ ì—ì´ì „íŠ¸ê°€ ëª¨ë“  ë‹¨ê³„ ì¶”ë¡ 
- ìµœëŒ€ 10íšŒ ë°˜ë³µ ì œí•œ
- ë©”ì‹œì§€ ëˆ„ì ìœ¼ë¡œ ì»¨í…ìŠ¤íŠ¸ ì¦ê°€

**After**:
- ê° ì „ë¬¸ ì—ì´ì „íŠ¸ê°€ ìì‹ ì˜ ì˜ì—­ë§Œ ì²˜ë¦¬
- Supervisorê°€ ìˆœì„œ ì¡°ì •
- ë¬´í•œ ì›Œí¬í”Œë¡œìš° ê°€ëŠ¥ (ê·¸ë˜í”„ ê¸°ë°˜)
- íš¨ìœ¨ì ì¸ ìƒíƒœ ê´€ë¦¬

### 4. ìœ ì§€ë³´ìˆ˜ ìš©ì´ì„±

**Before**:
- ìƒˆ ë„êµ¬ ì¶”ê°€ ì‹œ ALMAgent ìˆ˜ì •
- ëª¨ë“  ë„êµ¬ê°€ í•œ ì—ì´ì „íŠ¸ì— ì§‘ì¤‘
- ë„êµ¬ ê°„ ì±…ì„ ë¶ˆëª…í™•

**After**:
- ìƒˆ ë„êµ¬ ì¶”ê°€ ì‹œ í•´ë‹¹ ì „ë¬¸ ì—ì´ì „íŠ¸ë§Œ ìˆ˜ì •
- ì±…ì„ ë¶„ë¦¬ë¡œ ì½”ë“œ ê´€ë¦¬ ê°„ì†Œí™”
- ëª…í™•í•œ ë„ë©”ì¸ ê²½ê³„

---

## ë¦¬ìŠ¤í¬ ë° ëŒ€ì‘

### ë¦¬ìŠ¤í¬ 1: ë³µì¡ë„ ì¦ê°€

**ìœ„í—˜ë„**: ì¤‘ê°„
**ì˜í–¥**: ì´ˆê¸° ê°œë°œ ì‹œê°„ ì¦ê°€, í•™ìŠµ ê³¡ì„ 

**ëŒ€ì‘**:
- ë‹¨ê³„ë³„ êµ¬í˜„ (Phase 1ë¶€í„° ìˆœì°¨ ì§„í–‰)
- ê¸°ì¡´ [chatbot.ipynb](../chatbot.ipynb) ìœ ì§€ (ë¡¤ë°± ê°€ëŠ¥)
- PoC (Proof of Concept) ë¨¼ì € êµ¬í˜„ (2-3ê°œ ì—ì´ì „íŠ¸)

### ë¦¬ìŠ¤í¬ 2: LangGraph í•™ìŠµ ê³¡ì„ 

**ìœ„í—˜ë„**: ë‚®ìŒ
**ì˜í–¥**: ê°œë°œ ì´ˆê¸° ì†ë„ ì €í•˜

**ëŒ€ì‘**:
- ê³µì‹ ë¬¸ì„œ ì°¸ì¡°: https://langchain-ai.github.io/langgraph/
- ê°„ë‹¨í•œ ì˜ˆì œë¶€í„° ì‹œì‘ (Hello World ìˆ˜ì¤€)
- ê¸°ì¡´ LangChain ì§€ì‹ í™œìš©

### ë¦¬ìŠ¤í¬ 3: Supervisorì˜ ë¼ìš°íŒ… ì˜¤ë¥˜

**ìœ„í—˜ë„**: ì¤‘ê°„
**ì˜í–¥**: ì˜ëª»ëœ ì—ì´ì „íŠ¸ ì„ íƒ â†’ ì‘ì—… ì‹¤íŒ¨

**ëŒ€ì‘**:
- Few-shot ì˜ˆì œ ì¶”ê°€ (í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§)
- ë¼ìš°íŒ… ë¡œê·¸ ë¶„ì„ ë° ê°œì„ 
- ì‚¬ìš©ì í”¼ë“œë°± ë°˜ì˜ ë©”ì»¤ë‹ˆì¦˜

### ë¦¬ìŠ¤í¬ 4: ì—ì´ì „íŠ¸ ê°„ í†µì‹  ì˜¤ë²„í—¤ë“œ

**ìœ„í—˜ë„**: ë‚®ìŒ
**ì˜í–¥**: ì•½ê°„ì˜ ì„±ëŠ¥ ì €í•˜ ê°€ëŠ¥

**ëŒ€ì‘**:
- ìƒíƒœ ê³µìœ  ìµœì í™” (í•„ìš”í•œ ì •ë³´ë§Œ ì „ë‹¬)
- ìºì‹± ë©”ì»¤ë‹ˆì¦˜ ì ìš©
- ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë° í”„ë¡œíŒŒì¼ë§

---

## íŒŒì¼ êµ¬ì¡°

```
/Users/boon/Dropbox/02_works/95_claude/
â”œâ”€â”€ multi_agent/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base.py                    # BaseAgent í´ë˜ìŠ¤
â”‚   â”œâ”€â”€ state.py                   # AgentState ì •ì˜
â”‚   â”œâ”€â”€ supervisor.py              # SupervisorAgent
â”‚   â”œâ”€â”€ workflow.py                # LangGraph ì›Œí¬í”Œë¡œìš°
â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ search_agent.py        # Search Agent (1ê°œ ë„êµ¬)
â”‚   â”‚   â”œâ”€â”€ market_agent.py        # Market Agent (2ê°œ ë„êµ¬)
â”‚   â”‚   â”œâ”€â”€ analysis_agent.py      # Analysis Agent (4ê°œ ë„êµ¬)
â”‚   â”‚   â”œâ”€â”€ position_agent.py      # Position Agent (2ê°œ ë„êµ¬)
â”‚   â”‚   â”œâ”€â”€ report_agent.py        # Report Agent (1ê°œ ë„êµ¬)
â”‚   â”‚   â””â”€â”€ export_agent.py        # Export Agent (1ê°œ ë„êµ¬)
â”‚   â””â”€â”€ prompts/
â”‚       â”œâ”€â”€ supervisor_prompt.py   # Supervisor í”„ë¡¬í”„íŠ¸
â”‚       â””â”€â”€ agent_prompts.py       # ê° ì—ì´ì „íŠ¸ í”„ë¡¬í”„íŠ¸
â”‚
â”œâ”€â”€ chatbot_multiagent.ipynb       # ìƒˆë¡œìš´ ë…¸íŠ¸ë¶ (ë©€í‹°ì—ì´ì „íŠ¸ ë²„ì „)
â”œâ”€â”€ chatbot.ipynb                  # ê¸°ì¡´ ë…¸íŠ¸ë¶ (ë‹¨ì¼ ì—ì´ì „íŠ¸, ìœ ì§€)
â”‚
â”œâ”€â”€ agent.py                       # ê¸°ì¡´ ALMAgent (ì°¸ê³ ìš©)
â”œâ”€â”€ alm_tools.py                   # 11ê°œ ë„êµ¬ (ì¬ì‚¬ìš©)
â”œâ”€â”€ alm_functions.py               # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ (ì¬ì‚¬ìš©)
â”œâ”€â”€ prompts.py                     # ê¸°ì¡´ í”„ë¡¬í”„íŠ¸ (ì°¸ê³ ìš©)
â”‚
â””â”€â”€ docs/
    â”œâ”€â”€ MODULE_GUIDE.md            # ì „ì²´ ëª¨ë“ˆ ê°€ì´ë“œ
    â””â”€â”€ MULTIAGENT_ARCHITECTURE.md # ì´ ë¬¸ì„œ
```

---

## ê²°ë¡ 

ë©€í‹°ì—ì´ì „íŠ¸ ì•„í‚¤í…ì²˜ëŠ” ë‹¤ìŒì„ ì œê³µí•©ë‹ˆë‹¤:

1. âœ… **ë„êµ¬ ì„ íƒ ì •í™•ë„ í–¥ìƒ** (ì£¼ìš” ëª©í‘œ) - 6ë°° ê°œì„ 
2. âœ… **ë³‘ë ¬ ì²˜ë¦¬ë¡œ ì„±ëŠ¥ ê°œì„ ** - ìµœëŒ€ 2ë°° í–¥ìƒ
3. âœ… **ë³µì¡í•œ ì›Œí¬í”Œë¡œìš° ì²˜ë¦¬ ëŠ¥ë ¥** - ë¬´ì œí•œ ë‹¨ê³„ ê°€ëŠ¥
4. âœ… **ìœ ì§€ë³´ìˆ˜ ìš©ì´ì„±** - ì±…ì„ ë¶„ë¦¬ ë° ëª¨ë“ˆí™”

### ì¶”ì²œ êµ¬í˜„ ìˆœì„œ

1. **Phase 1-2**: ê¸°ë³¸ ì¸í”„ë¼ + 2-3ê°œ ì—ì´ì „íŠ¸ (PoC) â†’ 1ì£¼ì¼
2. **Phase 3-4**: Supervisor + LangGraph í†µí•© â†’ 1ì£¼ì¼
3. **Phase 5-6**: ì „ì²´ í…ŒìŠ¤íŠ¸ ë° ìµœì í™” â†’ 4-5ì¼

**ì´ ì˜ˆìƒ ê¸°ê°„**: ì•½ 2.5-3ì£¼

---

**ë‹¤ìŒ ë‹¨ê³„**: Phase 1 êµ¬í˜„ ì‹œì‘ - ê¸°ë³¸ ì¸í”„ë¼ êµ¬ì¶•

**ê´€ë ¨ ë¬¸ì„œ**:
- [MODULE_GUIDE.md](MODULE_GUIDE.md) - ì „ì²´ ëª¨ë“ˆ êµ¬ì¡°
- [agent.py](../agent.py) - í˜„ì¬ ë‹¨ì¼ ì—ì´ì „íŠ¸ êµ¬í˜„
- [alm_tools.py](../alm_tools.py) - 11ê°œ ë„êµ¬ ì •ì˜
